{% extends "base.html" %}

{% block title %}Payroll Report - CS631 Company Database{% endblock %}

{% block content %}
<h2>Process Payroll (READ)</h2>

<form method="POST" action="/hr/payroll">
    <h3>Select Pay Period</h3>
    <label>Year:</label><br>
    <input type="number" name="year" min="2020" max="2030" value="2025" required><br><br>
    
    <label>Month:</label><br>
    <select name="month" required>
        <option value="1">January</option>
        <option value="2">February</option>
        <option value="3" selected>March</option>
        <option value="4">April</option>
        <option value="5">May</option>
        <option value="6">June</option>
        <option value="7">July</option>
        <option value="8">August</option>
        <option value="9">September</option>
        <option value="10">October</option>
        <option value="11">November</option>
        <option value="12">December</option>
    </select><br><br>
    
    <button type="submit">Process Payroll</button>
    <a href="/hr"><button type="button">Back to HR Dashboard</button></a>
</form>

{% if processed %}
<hr>
<h3>Payroll Report - {{ month }}/{{ year }}</h3>

{% if payroll_data %}
<p>Total Records: {{ payroll_data|length }}</p>

<table border="1" cellpadding="5" cellspacing="0">
    <thead>
        <tr>
            <th>Employee #</th>
            <th>Name</th>
            <th>Gross Pay</th>
            <th>Federal Tax</th>
            <th>State Tax</th>
            <th>Other Tax</th>
            <th>Net Pay</th>
            <th>Payment Date</th>
        </tr>
    </thead>
    <tbody>
        {% for record in payroll_data %}
        <tr>
            <td>{{ record[0] }}</td>
            <td>{{ record[1] }}</td>
            <td>${{ "{:,.2f}".format(record[2]) }}</td>
            <td>${{ "{:,.2f}".format(record[3]) }}</td>
            <td>${{ "{:,.2f}".format(record[4]) }}</td>
            <td>${{ "{:,.2f}".format(record[5]) }}</td>
            <td>${{ "{:,.2f}".format(record[6]) }}</td>
            <td>{{ record[7] }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<p>No payroll records found for this period.</p>
{% endif %}
{% endif %}

<p><a href="/hr">‚Üê Back to HR Dashboard</a></p>
{% endblock %}
